<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PÃ¤Ã¤tÃ¶sTutka â€” Kokkola</title>
<link rel="stylesheet" href="style.css">
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Mono:wght@300;400;500&family=Syne:wght@400;600;800&display=swap" rel="stylesheet">
<style>
Â  :root {
Â  Â  --bg: #0a0c0f;
Â  Â  --bg2: #10141a;
Â  Â  --bg3: #161c24;
Â  Â  --border: #1e2830;
Â  Â  --border2: #2a3540;
Â  Â  --text: #e8edf2;
Â  Â  --text2: #8a9ab0;
Â  Â  --text3: #4a5a6a;
Â  Â  --accent: #3b82f6;
Â  Â  --accent2: #1d4ed8;
Â  Â  --green: #22c55e;
Â  Â  --red: #ef4444;
Â  Â  --amber: #f59e0b;
Â  Â  --cyan: #06b6d4;
Â  }

Â  * { margin: 0; padding: 0; box-sizing: border-box; }

Â  body {
Â  Â  background: var(--bg);
Â  Â  color: var(--text);
Â  Â  font-family: 'DM Mono', monospace;
Â  Â  min-height: 100vh;
Â  Â  overflow-x: hidden;
Â  }

Â  /* NAV */
Â  nav {
Â  Â  position: fixed; top: 0; left: 0; right: 0; z-index: 100;
Â  Â  display: flex; align-items: center; justify-content: space-between;
Â  Â  padding: 16px 32px;
Â  Â  background: rgba(10,12,15,0.85);
Â  Â  backdrop-filter: blur(20px);
Â  Â  border-bottom: 1px solid var(--border);
Â  }

Â  .nav-logo {
Â  Â  font-family: 'Syne', sans-serif;
Â  Â  font-weight: 800;
Â  Â  font-size: 1.1rem;
Â  Â  letter-spacing: -0.02em;
Â  Â  color: var(--text);
Â  }
Â  .nav-logo span { color: var(--accent); }

Â  .nav-links { display: flex; gap: 4px; }
Â  .nav-btn {
Â  Â  padding: 7px 16px;
Â  Â  border-radius: 6px;
Â  Â  border: none;
Â  Â  background: transparent;
Â  Â  color: var(--text2);
Â  Â  font-family: 'DM Mono', monospace;
Â  Â  font-size: 0.78rem;
Â  Â  cursor: pointer;
Â  Â  transition: all 0.15s;
Â  Â  letter-spacing: 0.03em;
Â  }
Â  .nav-btn:hover { background: var(--bg3); color: var(--text); }
Â  .nav-btn.active { background: var(--bg3); color: var(--text); }
Â  .nav-btn.cta {
Â  Â  background: var(--accent);
Â  Â  color: #fff;
Â  }
Â  .nav-btn.cta:hover { background: var(--accent2); }

Â  /* VIEWS */
Â  .view { display: none; padding-top: 64px; }
Â  .view.active { display: block; }

Â  /* ====== LANDING ====== */
Â  .landing {
Â  Â  min-height: 100vh;
Â  Â  display: grid;
Â  Â  grid-template-rows: 1fr auto;
Â  }

Â  .hero {
Â  Â  display: flex;
Â  Â  flex-direction: column;
Â  Â  align-items: center;
Â  Â  justify-content: center;
Â  Â  min-height: calc(100vh - 64px);
Â  Â  text-align: center;
Â  Â  padding: 60px 32px;
Â  Â  position: relative;
Â  Â  overflow: hidden;
Â  }

Â  .hero::before {
Â  Â  content: '';
Â  Â  position: absolute;
Â  Â  width: 600px; height: 600px;
Â  Â  background: radial-gradient(circle, rgba(59,130,246,0.08) 0%, transparent 70%);
Â  Â  top: 50%; left: 50%;
Â  Â  transform: translate(-50%, -50%);
Â  Â  pointer-events: none;
Â  }

Â  .hero-tag {
Â  Â  display: inline-flex;
Â  Â  align-items: center;
Â  Â  gap: 8px;
Â  Â  padding: 5px 14px;
Â  Â  background: rgba(59,130,246,0.1);
Â  Â  border: 1px solid rgba(59,130,246,0.25);
Â  Â  border-radius: 100px;
Â  Â  font-size: 0.72rem;
Â  Â  color: var(--accent);
Â  Â  letter-spacing: 0.1em;
Â  Â  text-transform: uppercase;
Â  Â  margin-bottom: 32px;
Â  Â  animation: fadeUp 0.6s ease both;
Â  }

Â  .hero-tag::before {
Â  Â  content: '';
Â  Â  width: 6px; height: 6px;
Â  Â  background: var(--accent);
Â  Â  border-radius: 50%;
Â  Â  animation: pulse 2s infinite;
Â  }

Â  @keyframes pulse {
Â  Â  0%,100% { opacity: 1; transform: scale(1); }
Â  Â  50% { opacity: 0.5; transform: scale(0.8); }
Â  }

Â  .hero h1 {
Â  Â  font-family: 'DM Serif Display', serif;
Â  Â  font-size: clamp(3rem, 8vw, 6rem);
Â  Â  line-height: 1.0;
Â  Â  letter-spacing: -0.02em;
Â  Â  max-width: 900px;
Â  Â  margin-bottom: 24px;
Â  Â  animation: fadeUp 0.6s 0.1s ease both;
Â  }

Â  .hero h1 em {
Â  Â  font-style: italic;
Â  Â  color: var(--accent);
Â  }

Â  .hero p {
Â  Â  font-size: 1rem;
Â  Â  color: var(--text2);
Â  Â  max-width: 520px;
Â  Â  line-height: 1.7;
Â  Â  margin-bottom: 48px;
Â  Â  animation: fadeUp 0.6s 0.2s ease both;
Â  Â  font-family: 'DM Mono', monospace;
Â  Â  font-weight: 300;
Â  }

Â  .hero-cta {
Â  Â  display: flex;
Â  Â  gap: 12px;
Â  Â  animation: fadeUp 0.6s 0.3s ease both;
Â  }

Â  .btn-primary {
Â  Â  padding: 13px 28px;
Â  Â  background: var(--accent);
Â  Â  color: #fff;
Â  Â  border: none;
Â  Â  border-radius: 8px;
Â  Â  font-family: 'DM Mono', monospace;
Â  Â  font-size: 0.85rem;
Â  Â  cursor: pointer;
Â  Â  transition: all 0.2s;
Â  Â  letter-spacing: 0.02em;
Â  }
Â  .btn-primary:hover { background: var(--accent2); transform: translateY(-1px); }

Â  .btn-secondary {
Â  Â  padding: 13px 28px;
Â  Â  background: transparent;
Â  Â  color: var(--text2);
Â  Â  border: 1px solid var(--border2);
Â  Â  border-radius: 8px;
Â  Â  font-family: 'DM Mono', monospace;
Â  Â  font-size: 0.85rem;
Â  Â  cursor: pointer;
Â  Â  transition: all 0.2s;
Â  }
Â  .btn-secondary:hover { border-color: var(--text3); color: var(--text); }

Â  .features {
Â  Â  display: grid;
Â  Â  grid-template-columns: repeat(3, 1fr);
Â  Â  gap: 1px;
Â  Â  background: var(--border);
Â  Â  border-top: 1px solid var(--border);
Â  Â  animation: fadeUp 0.6s 0.4s ease both;
Â  }

Â  .feature {
Â  Â  background: var(--bg);
Â  Â  padding: 40px 32px;
Â  Â  transition: background 0.2s;
Â  }
Â  .feature:hover { background: var(--bg2); }

Â  .feature-icon {
Â  Â  font-size: 1.5rem;
Â  Â  margin-bottom: 16px;
Â  }

Â  .feature h3 {
Â  Â  font-family: 'Syne', sans-serif;
Â  Â  font-size: 0.95rem;
Â  Â  font-weight: 600;
Â  Â  margin-bottom: 8px;
Â  Â  color: var(--text);
Â  }

Â  .feature p {
Â  Â  font-size: 0.78rem;
Â  Â  color: var(--text2);
Â  Â  line-height: 1.7;
Â  Â  font-weight: 300;
Â  }

Â  @keyframes fadeUp {
Â  Â  from { opacity: 0; transform: translateY(20px); }
Â  Â  to { opacity: 1; transform: translateY(0); }
Â  }

Â  /* ====== DASHBOARD ====== */
Â  .dashboard {
Â  Â  padding: 32px;
Â  Â  max-width: 1400px;
Â  Â  margin: 0 auto;
Â  Â  display: grid;
Â  Â  gap: 24px;
Â  }

Â  .dash-header {
Â  Â  display: flex;
Â  Â  align-items: flex-end;
Â  Â  justify-content: space-between;
Â  Â  animation: fadeUp 0.4s ease both;
Â  }

Â  .dash-title {
Â  Â  font-family: 'DM Serif Display', serif;
Â  Â  font-size: 2rem;
Â  Â  line-height: 1.1;
Â  }
Â  .dash-title span { color: var(--text2); font-size: 1rem; font-family: 'DM Mono'; font-weight: 300; display: block; margin-bottom: 4px; }

Â  .dash-date {
Â  Â  font-size: 0.75rem;
Â  Â  color: var(--text3);
Â  Â  letter-spacing: 0.06em;
Â  Â  text-transform: uppercase;
Â  }

Â  /* STATS ROW */
Â  .stats-row {
Â  Â  display: grid;
Â  Â  grid-template-columns: repeat(4, 1fr);
Â  Â  gap: 16px;
Â  Â  animation: fadeUp 0.4s 0.1s ease both;
Â  }

Â  .stat-card {
Â  Â  background: var(--bg2);
Â  Â  border: 1px solid var(--border);
Â  Â  border-radius: 12px;
Â  Â  padding: 20px 24px;
Â  Â  transition: border-color 0.2s;
Â  Â  position: relative;
Â  Â  overflow: hidden;
Â  }
Â  .stat-card::before {
Â  Â  content: '';
Â  Â  position: absolute;
Â  Â  top: 0; left: 0; right: 0;
Â  Â  height: 2px;
Â  Â  background: var(--accent-color, var(--accent));
Â  Â  opacity: 0.6;
Â  }
Â  .stat-card:hover { border-color: var(--border2); }

Â  .stat-label {
Â  Â  font-size: 0.7rem;
Â  Â  color: var(--text3);
Â  Â  letter-spacing: 0.08em;
Â  Â  text-transform: uppercase;
Â  Â  margin-bottom: 10px;
Â  }

Â  .stat-value {
Â  Â  font-family: 'Syne', sans-serif;
Â  Â  font-size: 2rem;
Â  Â  font-weight: 800;
Â  Â  line-height: 1;
Â  Â  margin-bottom: 6px;
Â  }

Â  .stat-change {
Â  Â  font-size: 0.72rem;
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  gap: 4px;
Â  }
Â  .stat-change.up { color: var(--green); }
Â  .stat-change.down { color: var(--red); }
Â  .stat-change.neutral { color: var(--text3); }

Â  /* MAIN GRID */
Â  .main-grid {
Â  Â  display: grid;
Â  Â  grid-template-columns: 1fr;
Â  Â  gap: 16px;
Â  Â  animation: fadeUp 0.4s 0.2s ease both;
Â  }

Â  .card {
Â  Â  background: var(--bg2);
Â  Â  border: 1px solid var(--border);
Â  Â  border-radius: 12px;
Â  Â  overflow: hidden;
Â  }

Â  .card-header {
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  justify-content: space-between;
Â  Â  padding: 18px 24px;
Â  Â  border-bottom: 1px solid var(--border);
Â  }

Â  .card-title {
Â  Â  font-family: 'Syne', sans-serif;
Â  Â  font-size: 0.85rem;
Â  Â  font-weight: 600;
Â  Â  letter-spacing: 0.02em;
Â  }

Â  .card-badge {
Â  Â  font-size: 0.65rem;
Â  Â  padding: 3px 10px;
Â  Â  border-radius: 100px;
Â  Â  background: rgba(59,130,246,0.1);
Â  Â  border: 1px solid rgba(59,130,246,0.2);
Â  Â  color: var(--accent);
Â  Â  letter-spacing: 0.04em;
Â  }

Â  /* DECISIONS LIST */
Â  .decision-item {
Â  Â  padding: 18px 24px;
Â  Â  border-bottom: 1px solid var(--border);
Â  Â  cursor: pointer;
Â  Â  transition: background 0.15s;
Â  Â  display: grid;
Â  Â  grid-template-columns: auto 1fr auto;
Â  Â  gap: 14px;
Â  Â  align-items: start;
Â  }
Â  .decision-item:last-child { border-bottom: none; }
Â  .decision-item:hover { background: var(--bg3); }

Â  .decision-dot {
Â  Â  width: 8px; height: 8px;
Â  Â  border-radius: 50%;
Â  Â  margin-top: 5px;
Â  Â  flex-shrink: 0;
Â  }

Â  .decision-content {}
Â  .decision-title {
Â  Â  font-size: 0.82rem;
Â  Â  color: var(--text);
Â  Â  margin-bottom: 4px;
Â  Â  line-height: 1.4;
Â  Â  word-break: break-word;
Â  }

Â  .decision-meta {
Â  Â  font-size: 0.68rem;
Â  Â  color: var(--text3);
Â  Â  display: flex;
Â  Â  gap: 10px;
Â  }

Â  .decision-status {
Â  Â  font-size: 0.65rem;
Â  Â  padding: 3px 10px;
Â  Â  border-radius: 6px;
Â  Â  white-space: nowrap;
Â  Â  align-self: start;
Â  Â  letter-spacing: 0.04em;
Â  }

Â  .status-upcoming { background: rgba(245,158,11,0.1); color: var(--amber); border: 1px solid rgba(245,158,11,0.2); }
Â  .status-passed { background: rgba(34,197,94,0.1); color: var(--green); border: 1px solid rgba(34,197,94,0.2); }
Â  .status-rejected { background: rgba(239,68,68,0.1); color: var(--red); border: 1px solid rgba(239,68,68,0.2); }
Â  .status-review { background: rgba(6,182,212,0.1); color: var(--cyan); border: 1px solid rgba(6,182,212,0.2); }

Â  /* CHART AREA */
Â  .chart-area {
Â  Â  padding: 24px;
Â  }

Â  .chart-bars {
Â  Â  display: flex;
Â  Â  align-items: flex-end;
Â  Â  gap: 8px;
Â  Â  height: 120px;
Â  Â  margin-bottom: 8px;
Â  }

Â  .bar-group {
Â  Â  flex: 1;
Â  Â  display: flex;
Â  Â  flex-direction: column;
Â  Â  align-items: center;
Â  Â  gap: 4px;
Â  Â  height: 100%;
Â  Â  justify-content: flex-end;
Â  }

Â  .bar {
Â  Â  width: 100%;
Â  Â  border-radius: 3px 3px 0 0;
Â  Â  background: var(--accent);
Â  Â  opacity: 0.7;
Â  Â  transition: opacity 0.2s;
Â  Â  min-height: 4px;
Â  }
Â  .bar:hover { opacity: 1; }

Â  .bar-label {
Â  Â  font-size: 0.6rem;
Â  Â  color: var(--text3);
Â  Â  letter-spacing: 0.04em;
Â  }

Â  /* SIDE PANEL */
Â  .side-panel { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }

Â  .mini-card {
Â  Â  background: var(--bg2);
Â  Â  border: 1px solid var(--border);
Â  Â  border-radius: 12px;
Â  Â  overflow: hidden;
Â  }

Â  .upcoming-item {
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  gap: 12px;
Â  Â  padding: 8px 16px;
Â  Â  border-bottom: 1px solid var(--border);
Â  Â  text-decoration: none;
Â  Â  color: inherit;
Â  Â  transition: background 0.15s;
Â  }
Â  .upcoming-item:last-child { border-bottom: none; }
Â  .upcoming-item:hover { background: var(--surface2); }
Â  .upcoming-item:hover .upcoming-title { color: var(--cyan); }

Â  .upcoming-date {
Â  Â  font-size: 0.68rem;
Â  Â  color: var(--amber);
Â  Â  letter-spacing: 0.04em;
Â  Â  text-transform: uppercase;
Â  Â  white-space: nowrap;
Â  Â  min-width: 90px;
Â  }

Â  .upcoming-title {
Â  Â  font-size: 0.8rem;
Â  Â  color: var(--text1);
Â  Â  line-height: 1.3;
Â  Â  flex: 1;
Â  }

Â  .upcoming-body {
Â  Â  font-size: 0.68rem;
Â  Â  color: var(--text3);
Â  Â  white-space: nowrap;
Â  }

Â  /* NEWS GRID */
Â  .news-grid {
Â  Â  display: grid;
Â  Â  grid-template-columns: 1fr 1fr;
Â  Â  gap: 16px;
Â  Â  margin-top: 16px;
Â  }
Â  @media (max-width: 768px) { .news-grid { grid-template-columns: 1fr; } }
Â  .news-item {
Â  Â  display: flex;
Â  Â  flex-direction: column;
Â  Â  gap: 2px;
Â  Â  padding: 10px 0;
Â  Â  border-bottom: 1px solid var(--border);
Â  Â  text-decoration: none;
Â  Â  color: inherit;
Â  Â  transition: background 0.15s;
Â  }
Â  .news-item:last-child { border-bottom: none; }
Â  .news-item:hover .news-title { color: var(--cyan); }
Â  .news-title { font-size: 0.8rem; color: var(--text1); line-height: 1.4; }
Â  .news-meta { font-size: 0.68rem; color: var(--text3); }
Â  .news-desc { font-size: 0.72rem; color: var(--text2); margin-top: 2px; line-height: 1.3; }

Â  /* BOTTOM GRID */
Â  .bottom-grid {
Â  Â  display: grid;
Â  Â  grid-template-columns: repeat(3, 1fr);
Â  Â  gap: 16px;
Â  Â  animation: fadeUp 0.4s 0.3s ease both;
Â  }
Â  @media (max-width: 1100px) {
Â  Â  .bottom-grid { grid-template-columns: 1fr 1fr; }
Â  Â  .side-panel { grid-template-columns: 1fr; }
Â  }

Â  .trend-row {
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  justify-content: space-between;
Â  Â  padding: 12px 20px;
Â  Â  border-bottom: 1px solid var(--border);
Â  Â  font-size: 0.78rem;
Â  }
Â  .trend-row:last-child { border-bottom: none; }

Â  .trend-label { color: var(--text2); font-size: 0.72rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 160px; }
Â  .trend-value { font-family: 'Syne', sans-serif; font-weight: 600; white-space: nowrap; }
Â  .trend-bar-container {
Â  Â  padding: 14px 20px 16px;
Â  Â  display: flex;
Â  Â  flex-direction: column;
Â  Â  gap: 10px;
Â  }
Â  .trend-bar-row { display: flex; flex-direction: column; gap: 4px; }
Â  .trend-bar-info { display: flex; justify-content: space-between; font-size: 0.68rem; color: var(--text2); }
Â  .trend-bar-track { height: 4px; background: var(--border2); border-radius: 2px; overflow: hidden; }
Â  .trend-bar-fill { height: 100%; border-radius: 2px; transition: width 1s ease; }

Â  /* MODAL */
Â  .modal-overlay {
Â  Â  position: fixed; inset: 0; z-index: 200;
Â  Â  background: rgba(0,0,0,0.7);
Â  Â  backdrop-filter: blur(4px);
Â  Â  display: flex; align-items: center; justify-content: center;
Â  Â  opacity: 0; pointer-events: none;
Â  Â  transition: opacity 0.2s;
Â  }
Â  .modal-overlay.open { opacity: 1; pointer-events: all; }

Â  .modal {
Â  Â  background: var(--bg2);
Â  Â  border: 1px solid var(--border2);
Â  Â  border-radius: 16px;
Â  Â  padding: 32px;
Â  Â  max-width: 520px; width: 90%;
Â  Â  transform: translateY(16px);
Â  Â  transition: transform 0.2s;
Â  }
Â  .modal-overlay.open .modal { transform: translateY(0); }

Â  .modal-tag {
Â  Â  font-size: 0.65rem;
Â  Â  color: var(--text3);
Â  Â  letter-spacing: 0.1em;
Â  Â  text-transform: uppercase;
Â  Â  margin-bottom: 10px;
Â  }

Â  .modal-title {
Â  Â  font-family: 'DM Serif Display', serif;
Â  Â  font-size: 1.5rem;
Â  Â  margin-bottom: 16px;
Â  Â  line-height: 1.3;
Â  }

Â  .modal-body {
Â  Â  font-size: 0.8rem;
Â  Â  color: var(--text2);
Â  Â  line-height: 1.8;
Â  Â  margin-bottom: 24px;
Â  Â  font-weight: 300;
Â  }

Â  .modal-footer {
Â  Â  display: flex;
Â  Â  gap: 10px;
Â  }

Â  .modal-close {
Â  Â  padding: 10px 20px;
Â  Â  background: transparent;
Â  Â  border: 1px solid var(--border2);
Â  Â  color: var(--text2);
Â  Â  border-radius: 8px;
Â  Â  font-family: 'DM Mono', monospace;
Â  Â  font-size: 0.78rem;
Â  Â  cursor: pointer;
Â  Â  transition: all 0.15s;
Â  }
Â  .modal-close:hover { background: var(--bg3); color: var(--text); }

Â  /* SEARCH */
Â  .search-wrap {
Â  Â  position: relative;
Â  Â  display: flex;
Â  Â  align-items: center;
Â  }
Â  .search-icon {
Â  Â  position: absolute;
Â  Â  left: 12px;
Â  Â  color: var(--text3);
Â  Â  font-size: 0.85rem;
Â  Â  pointer-events: none;
Â  }
Â  .search-input {
Â  Â  background: var(--bg3);
Â  Â  border: 1px solid var(--border2);
Â  Â  border-radius: 8px;
Â  Â  padding: 7px 14px 7px 34px;
Â  Â  color: var(--text);
Â  Â  font-family: 'DM Mono', monospace;
Â  Â  font-size: 0.78rem;
Â  Â  width: 220px;
Â  Â  transition: all 0.2s;
Â  Â  outline: none;
Â  }
Â  .search-input::placeholder { color: var(--text3); }
Â  .search-input:focus {
Â  Â  border-color: var(--accent);
Â  Â  width: 280px;
Â  Â  background: var(--bg2);
Â  Â  box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
Â  }
Â  .search-clear {
Â  Â  position: absolute;
Â  Â  right: 10px;
Â  Â  background: none;
Â  Â  border: none;
Â  Â  color: var(--text3);
Â  Â  cursor: pointer;
Â  Â  font-size: 0.85rem;
Â  Â  padding: 2px 4px;
Â  Â  display: none;
Â  Â  line-height: 1;
Â  }
Â  .search-clear:hover { color: var(--text); }

Â  /* FILTERS */
Â  .filter-row {
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  gap: 8px;
Â  Â  padding: 12px 24px;
Â  Â  border-bottom: 1px solid var(--border);
Â  Â  flex-wrap: wrap;
Â  }
Â  .filter-label {
Â  Â  font-size: 0.65rem;
Â  Â  color: var(--text3);
Â  Â  letter-spacing: 0.08em;
Â  Â  text-transform: uppercase;
Â  Â  margin-right: 4px;
Â  }
Â  .filter-btn {
Â  Â  padding: 4px 12px;
Â  Â  border-radius: 100px;
Â  Â  border: 1px solid var(--border2);
Â  Â  background: transparent;
Â  Â  color: var(--text2);
Â  Â  font-family: 'DM Mono', monospace;
Â  Â  font-size: 0.68rem;
Â  Â  cursor: pointer;
Â  Â  transition: all 0.15s;
Â  Â  letter-spacing: 0.03em;
Â  }
Â  .filter-btn:hover { border-color: var(--text3); color: var(--text); }
Â  .filter-btn.active {
Â  Â  background: var(--accent);
Â  Â  border-color: var(--accent);
Â  Â  color: #fff;
Â  }
Â  .filter-btn.f-passed.active { background: var(--green); border-color: var(--green); }
Â  .filter-btn.f-rejected.active { background: var(--red); border-color: var(--red); }
Â  .filter-btn.f-upcoming.active { background: var(--amber); border-color: var(--amber); color: #000; }
Â  .filter-btn.f-review.active { background: var(--cyan); border-color: var(--cyan); color: #000; }
Â  .filter-btn.f-meeting.active { background: var(--cyan); border-color: var(--cyan); color: #000; }
Â  .filter-btn.f-meeting-future.active { background: var(--green); border-color: var(--green); color: #000; }
Â  .filter-btn.f-meeting-past.active { background: var(--text3); border-color: var(--text3); color: #000; }

Â  /* SEARCH EMPTY STATE */
Â  .search-empty {
Â  Â  padding: 40px 24px;
Â  Â  text-align: center;
Â  Â  display: none;
Â  }
Â  .search-empty-icon { font-size: 2rem; margin-bottom: 10px; }
Â  .search-empty-text { font-size: 0.78rem; color: var(--text3); }
Â  .search-highlight {
Â  Â  background: rgba(59,130,246,0.2);
Â  Â  color: var(--accent);
Â  Â  border-radius: 2px;
Â  Â  padding: 0 2px;
Â  }

Â  /* MEETING TABS */
Â  .meeting-tabs {
Â  Â  display: flex;
Â  Â  gap: 4px;
Â  Â  padding: 0 16px 12px;
Â  Â  border-bottom: 1px solid var(--border);
Â  }
Â  .meeting-tab {
Â  Â  background: none;
Â  Â  border: 1px solid var(--border2);
Â  Â  color: var(--text2);
Â  Â  font-size: 0.7rem;
Â  Â  padding: 4px 12px;
Â  Â  border-radius: 20px;
Â  Â  cursor: pointer;
Â  Â  font-family: 'Syne', sans-serif;
Â  Â  transition: all 0.15s;
Â  }
Â  .meeting-tab:hover { border-color: var(--accent); color: var(--accent); }
Â  .meeting-tab.active { background: var(--accent); border-color: var(--accent); color: #fff; }

Â  /* SCROLLBAR */
Â  ::-webkit-scrollbar { width: 4px; }
Â  ::-webkit-scrollbar-track { background: var(--bg); }
Â  ::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 2px; }

Â  /* ====== MOBIILI ====== */
Â  @media (max-width: 768px) {

Â  Â  /* Nav */
Â  Â  nav {
Â  Â  Â  padding: 12px 16px;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  gap: 8px;
Â  Â  }
Â  Â  .nav-links { gap: 2px; }
Â  Â  .nav-btn { padding: 6px 10px; font-size: 0.7rem; }
Â  Â  #nav-search { order: 3; width: 100%; }
Â  Â  .search-input { width: 100% !important; }

Â Â 

Â  /* Dashboard */
Â  Â  .dashboard { padding: 16px; gap: 16px; }

Â  Â  /* Header */
Â  Â  .dash-header {
Â  Â  Â  flex-direction: column !important;
Â  Â  Â  align-items: flex-start !important;
Â  Â  Â  gap: 4px;
Â  Â  }
Â  Â  .dash-title {
Â  Â  Â  font-size: 1.6rem !important;
Â  Â  }
Â  Â  .dash-title span {
Â  Â  Â  font-size: 0.75rem !important;
Â  Â  }
Â  Â  .dash-date { font-size: 0.65rem; }
Â  Â  .dash-title { font-size: 1.5rem; }

Â  Â  /* Stats â€” 2x2 ruudukko */
Â  Â  .stats-row {
Â  Â  Â  grid-template-columns: 1fr 1fr !important;
Â  Â  }
Â  Â  .stat-value { font-size: 1.4rem; }
Â  Â  .stat-label { font-size: 0.65rem; }
Â  Â  .stat-change { font-size: 0.65rem; }

Â  Â  /* Main grid */
Â  Â  .main-grid { grid-template-columns: 1fr; }

Â  Â  /* Side panel */
Â  Â  .side-panel { grid-template-columns: 1fr; }

Â  Â  /* Bottom grid */
Â  Â  .bottom-grid { grid-template-columns: 1fr; }

Â  Â  /* Filter row */
Â  Â  .filter-row { gap: 6px; padding: 10px 16px; flex-wrap: wrap; }
Â  Â  .filter-btn { font-size: 0.65rem; padding: 3px 8px; }

Â  Â  /* Decision items */
Â  Â  .decision-item { padding: 14px 16px; gap: 10px; }
Â  Â  .decision-title { font-size: 0.78rem; }
Â  Â  .decision-meta { font-size: 0.63rem; }
Â  Â  .decision-status { font-size: 0.6rem; padding: 2px 7px; }

Â  Â  /* Cards */
Â  Â  .card-header { padding: 14px 16px; }
Â  Â  .card-title { font-size: 0.8rem; }
Â  Â  .trend-row { padding: 10px 16px; }

Â  Â  /* Hero */
Â  Â  .hero h1 { font-size: 2.5rem; }
Â  Â  .features { grid-template-columns: 1fr; }

Â  Â  /* Modal */
Â  Â  .modal { padding: 24px 20px; }
Â  Â  .modal-title { font-size: 1.2rem; }
Â  }

Â  @media (max-width: 480px) {
Â  Â  .stats-row { grid-template-columns: 1fr 1fr; }
Â  Â  .stat-value { font-size: 1.2rem; }
Â  Â  nav .nav-btn.cta { display: none; }
Â  }
</style>
</head>
<body>

<!-- NAV -->
<nav>
Â  <div class="nav-logo">PÃ¤Ã¤tÃ¶s<span>Tutka</span></div>
Â  <div class="search-wrap" id="nav-search" style="display:none">
Â  Â  <span class="search-icon">ğŸ”</span>
Â  Â  <input class="search-input" id="searchInput" type="text" placeholder="Hae pÃ¤Ã¤tÃ¶ksiÃ¤..." oninput="handleSearch(this.value)" onkeydown="if(event.key==='Escape'){clearSearch()}">
Â  Â  <button class="search-clear" id="searchClear" onclick="clearSearch()">âœ•</button>
Â  </div>
Â  <div class="nav-links">
Â  Â  <button class="nav-btn active" onclick="showView('landing')">Etusivu</button>
Â  Â  <button class="nav-btn" onclick="showView('dashboard')">Dashboard</button>
Â  Â  <button class="nav-btn cta" onclick="showView('dashboard')">Kirjaudu sisÃ¤Ã¤n â†’</button>
Â  </div>
</nav>

<!-- LANDING VIEW -->
<div class="view active" id="view-landing">
Â  <div class="landing">
Â  Â  <div class="hero">
Â  Â  Â  <div class="hero-tag">Paikallinen demokratia</div>
Â  Â  Â  <h1>Parempia pÃ¤Ã¤tÃ¶ksiÃ¤<br><em>datalla tuettuna.</em></h1>
Â  Â  Â  <p>Seuraa kaupunkisi pÃ¤Ã¤tÃ¶ksentekoa reaaliajassa. Tulevat kokoukset, tÃ¤rkeÃ¤t Ã¤Ã¤nestykset ja tuoreimmat tilastotiedot â€” yhdessÃ¤ paikassa.</p>
Â  Â  Â  <div class="hero-cta">
Â  Â  Â  Â  <button class="btn-primary" onclick="showView('dashboard')">Avaa dashboard â†’</button>
Â  Â  Â  Â  <button class="btn-secondary">Lue lisÃ¤Ã¤</button>
Â  Â  Â  </div>
Â  Â  </div>
Â  Â  <div class="features">
Â  Â  Â  <div class="feature">
Â  Â  Â  Â  <div class="feature-icon">ğŸ›ï¸</div>
Â  Â  Â  Â  <h3>PÃ¤Ã¤tÃ¶kset & kokoukset</h3>
Â  Â  Â  Â  <p>Tulevat valtuuston kokoukset, Ã¤Ã¤nestystulokset ja pÃ¤Ã¤tÃ¶sten historiatiedot helposti selattavissa.</p>
Â  Â  Â  </div>
Â  Â  Â  <div class="feature">
Â  Â  Â  Â  <div class="feature-icon">ğŸ“Š</div>
Â  Â  Â  Â  <h3>Talous & tilastot</h3>
Â  Â  Â  Â  <p>Kunnan taloustilanne, budjetin toteutuminen, vÃ¤estÃ¶kehitys ja tyÃ¶ttÃ¶myystilastot pÃ¤ivitettynÃ¤.</p>
Â  Â  Â  </div>
Â  Â  Â  <div class="feature">
Â  Â  Â  Â  <div class="feature-icon">ğŸ””</div>
Â  Â  Â  Â  <h3>Ilmoitukset</h3>
Â  Â  Â  Â  <p>Saat ilmoituksen kun seuraamiisi aiheisiin liittyviÃ¤ pÃ¤Ã¤tÃ¶ksiÃ¤ on tulossa tai tehty.</p>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</div>

<!-- DASHBOARD VIEW -->
<div class="view" id="view-dashboard">
Â  <div class="dashboard">

Â  Â  <!-- Header -->
Â  Â  <div class="dash-header">
Â  Â  Â  <div class="dash-title">
Â  Â  Â  Â  <span>PÃ¤Ã¤tÃ¶sTutka</span>
Â  Â  Â  Â  <span style="font-size:1rem;font-weight:600;color:var(--cyan);display:block;margin-top:3px;">Kokkola</span>
Â  Â  Â  Â  <span style="font-size:0.72rem;font-weight:400;opacity:0.6;display:block;">PÃ¤Ã¤tÃ¶kset ja kokousasiat</span>
Â  Â  Â  </div>
Â  Â  Â  <div class="dash-date" id="dash-date">Tiistai 25. helmikuuta 2026</div>
Â  Â  </div>

Â  Â  <!-- Stats -->
Â  Â  <div class="stats-row">
Â  Â  Â  <div class="stat-card" style="--accent-color: #06b6d4">
Â  Â  Â  Â  <div class="stat-label">Asukasluku</div>
Â  Â  Â  Â  <div class="stat-value" id="stat-vaesto">â³</div>
Â  Â  Â  Â  <div class="stat-change" id="stat-vaesto-change">ladataan...</div>
Â  Â  Â  </div>
Â  Â  Â  <div class="stat-card" style="--accent-color: #ef4444">
Â  Â  Â  Â  <div class="stat-label">TyÃ¶ttÃ¶myys</div>
Â  Â  Â  Â  <div class="stat-value" id="stat-tyottomyys">â³</div>
Â  Â  Â  Â  <div class="stat-change" id="stat-tyottomyys-change">ladataan...</div>
Â  Â  Â  </div>
Â  Â  Â  <div class="stat-card" style="--accent-color: #22c55e">
Â  Â  Â  Â  <div class="stat-label">Alle 18-vuotiaat</div>
Â  Â  Â  Â  <div class="stat-value" id="stat-nuoret">â³</div>
Â  Â  Â  Â  <div class="stat-change" id="stat-nuoret-change">ladataan...</div>
Â  Â  Â  </div>
Â  Â  Â  <div class="stat-card" style="--accent-color: #f59e0b">
Â  Â  Â  Â  <div class="stat-label">Tulevia pÃ¤Ã¤tÃ¶ksiÃ¤</div>
Â  Â  Â  Â  <div class="stat-value" id="stat-paatokset">â€”</div>
Â  Â  Â  Â  <div class="stat-change neutral">seuraavat 30 pv</div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <!-- Tulevat kokoukset -->
Â  Â  <div class="card" style="margin-bottom:16px;">
Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  <div class="card-title">Kokoukset</div>
Â  Â  Â  </div>
Â  Â  Â  <div class="filter-row" style="margin-bottom:8px;">
Â  Â  Â  Â  <span class="filter-label">Suodata:</span>
Â  Â  Â  Â  <button class="filter-btn active" id="mkf-tulevat" onclick="setMeetingFilter('tulevat', this)">Tulevat</button>
Â  Â  Â  Â  <button class="filter-btn" id="mkf-menneet" onclick="setMeetingFilter('menneet', this)">Menneet</button>
Â  Â  Â  Â  <button class="filter-btn" id="mkf-kh" onclick="setMeetingFilter('kh', this)">Kaupunginhallitus</button>
Â  Â  Â  Â  <button class="filter-btn" id="mkf-all" onclick="setMeetingFilter('all', this)">Kaikki</button>
Â  Â  Â  Â  <input id="meeting-search" type="text" placeholder="Hae kokous..." oninput="renderAgendasTop()" style="margin-left:auto;padding:4px 10px;background:var(--surface2);border:1px solid var(--border);border-radius:6px;color:var(--text1);font-size:0.78rem;width:150px;">
Â  Â  Â  </div>
Â  Â  Â  <div id="upcoming-meetings-list-top">
Â  Â  Â  Â  <div style="padding:16px;text-align:center;color:var(--text3);font-size:0.78rem;">â³ Ladataan...</div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <!-- Main Grid -->
Â  Â  <div class="main-grid">
Â  Â  Â  <!-- Decisions -->
Â  Â  Â  <div class="card">
Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  <div class="card-title">ViimeisimmÃ¤t & tulevat pÃ¤Ã¤tÃ¶kset</div>
Â  Â  Â  Â  Â  <div class="card-badge">14 kpl</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="filter-row">
Â  Â  Â  Â  Â  <span class="filter-label">Suodata:</span>
Â  Â  Â  Â  Â  <button class="filter-btn active" onclick="setFilter('all', this)">Kaikki</button>
Â  Â  Â  Â  Â  <button class="filter-btn f-passed" onclick="setFilter('viranomais', this)">ViranomaispÃ¤Ã¤tÃ¶kset</button>
Â  Â  Â  Â  Â  <button class="filter-btn f-review" onclick="setFilter('paatokset', this)">Tehdyt pÃ¤Ã¤tÃ¶kset</button>
Â  Â  Â  Â  Â  <button class="filter-btn f-upcoming" onclick="setFilter('esitykset', this)">Esitykset</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="decisions-list">
Â  Â  Â  Â  Â  <div style="padding: 32px 24px; text-align:center; color: var(--text3); font-size:0.8rem;">
Â  Â  Â  Â  Â  Â  â³ Ladataan pÃ¤Ã¤tÃ¶ksiÃ¤...
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button id="show-more-btn" onclick="showAll=true;applyFilters()" style="display:none;width:100%;padding:12px;margin-top:8px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;color:var(--text2);cursor:pointer;font-size:0.85rem;">NÃ¤ytÃ¤ kaikki pÃ¤Ã¤tÃ¶kset â–¼</button>
Â  Â  Â  Â  <div class="search-empty" id="search-empty">
Â  Â  Â  Â  Â  <div class="search-empty-icon">ğŸ”</div>
Â  Â  Â  Â  Â  <div class="search-empty-text">Ei hakutuloksia</div>
Â  Â  Â  Â  </div>


Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <!-- Kokoukset & kaavio -->
Â  Â  <div class="side-panel">

Â  Â  Â  Â  <div class="mini-card">
Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  <div class="card-title">Kokoukset</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="meeting-tabs">
Â  Â  Â  Â  Â  Â  <button class="meeting-tab active" onclick="switchMeetingTab('future', this)">Tulevat</button>
Â  Â  Â  Â  Â  Â  <button class="meeting-tab" onclick="switchMeetingTab('past', this)">Menneet</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div id="upcoming-meetings-list">
Â  Â  Â  Â  Â  Â  <div style="padding:16px;text-align:center;color:var(--text3);font-size:0.78rem;">â³ Ladataan...</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- Bar chart: kuukausipÃ¤Ã¤tÃ¶kset -->
Â  Â  Â  Â  <div class="mini-card">
Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  <div class="card-title">PÃ¤Ã¤tÃ¶ksiÃ¤ / kk</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="chart-area">
Â  Â  Â  Â  Â  Â  <div class="chart-bars">
Â  Â  Â  Â  Â  Â  Â  <div class="bar-group"><div class="bar" style="height:55%"></div><div class="bar-label">ELO</div></div>
Â  Â  Â  Â  Â  Â  Â  <div class="bar-group"><div class="bar" style="height:70%"></div><div class="bar-label">SYY</div></div>
Â  Â  Â  Â  Â  Â  Â  <div class="bar-group"><div class="bar" style="height:45%"></div><div class="bar-label">LOK</div></div>
Â  Â  Â  Â  Â  Â  Â  <div class="bar-group"><div class="bar" style="height:85%"></div><div class="bar-label">MAR</div></div>
Â  Â  Â  Â  Â  Â  Â  <div class="bar-group"><div class="bar" style="height:60%"></div><div class="bar-label">JOU</div></div>
Â  Â  Â  Â  Â  Â  Â  <div class="bar-group"><div class="bar" style="height:30%"></div><div class="bar-label">TAM</div></div>
Â  Â  Â  Â  Â  Â  Â  <div class="bar-group"><div class="bar" style="height:48%; background: var(--amber)"></div><div class="bar-label">HEL</div></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  </div>

Â  Â  <!-- Bottom Grid -->
Â  Â  <div class="bottom-grid">

Â  Â  Â  <!-- Taloustilanne -->
Â  Â  Â  <div class="card">
Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  <div class="card-title">Taloustilanne</div>
Â  Â  Â  Â  Â  <div class="card-badge">2026</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="trend-row">
Â  Â  Â  Â  Â  <span class="trend-label">Vuosikate</span>
Â  Â  Â  Â  Â  <span class="trend-value" style="color: var(--green)">+8,4 Mâ‚¬</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="trend-row">
Â  Â  Â  Â  Â  <span class="trend-label">Lainakanta / asukas</span>
Â  Â  Â  Â  Â  <span class="trend-value">3 842 â‚¬</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="trend-row">
Â  Â  Â  Â  Â  <span class="trend-label">Toimintakate</span>
Â  Â  Â  Â  Â  <span class="trend-value" style="color: var(--red)">âˆ’122 Mâ‚¬</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="trend-row">
Â  Â  Â  Â  Â  <span class="trend-label">Investointibudjetti</span>
Â  Â  Â  Â  Â  <span class="trend-value">22,1 Mâ‚¬</span>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <!-- VÃ¤estÃ¶ -->
Â  Â  Â  <div class="card">
Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  <div class="card-title">VÃ¤estÃ¶kehitys</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="trend-bar-container">
Â  Â  Â  Â  Â  <div class="trend-bar-row">
Â  Â  Â  Â  Â  Â  <div class="trend-bar-info"><span>0â€“17 v</span><span>19.2%</span></div>
Â  Â  Â  Â  Â  Â  <div class="trend-bar-track"><div class="trend-bar-fill" style="width:19.2%; background: var(--cyan)"></div></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="trend-bar-row">
Â  Â  Â  Â  Â  Â  <div class="trend-bar-info"><span>18â€“64 v</span><span>57.4%</span></div>
Â  Â  Â  Â  Â  Â  <div class="trend-bar-track"><div class="trend-bar-fill" style="width:57.4%; background: var(--accent)"></div></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="trend-bar-row">
Â  Â  Â  Â  Â  Â  <div class="trend-bar-info"><span>65+ v</span><span>23.4%</span></div>
Â  Â  Â  Â  Â  Â  <div class="trend-bar-track"><div class="trend-bar-fill" style="width:23.4%; background: var(--amber)"></div></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="trend-bar-row">
Â  Â  Â  Â  Â  Â  <div class="trend-bar-info"><span>Syntyvyys (â€°)</span><span>7.2 â€°</span></div>
Â  Â  Â  Â  Â  Â  <div class="trend-bar-track"><div class="trend-bar-fill" style="width:36%; background: var(--green)"></div></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="trend-bar-row">
Â  Â  Â  Â  Â  Â  <div class="trend-bar-info"><span>Nettomuutto</span><span>âˆ’124 hlÃ¶</span></div>
Â  Â  Â  Â  Â  Â  <div class="trend-bar-track"><div class="trend-bar-fill" style="width:62%; background: var(--red)"></div></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <!-- TyÃ¶llisyys -->
Â  Â  Â  <div class="card">
Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  <div class="card-title">TyÃ¶llisyys</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="trend-row">
Â  Â  Â  Â  Â  <span class="trend-label">TyÃ¶ttÃ¶myysaste</span>
Â  Â  Â  Â  Â  <span class="trend-value" style="color: var(--amber)">9.2%</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="trend-row">
Â  Â  Â  Â  Â  <span class="trend-label">NuorisotyÃ¶ttÃ¶myys</span>
Â  Â  Â  Â  Â  <span class="trend-value" style="color: var(--red)">14.8%</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="trend-row">
Â  Â  Â  Â  Â  <span class="trend-label">PitkÃ¤aikaistyÃ¶ttÃ¶mÃ¤t</span>
Â  Â  Â  Â  Â  <span class="trend-value">682 hlÃ¶</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="trend-row">
Â  Â  Â  Â  Â  <span class="trend-label">Avoimet tyÃ¶paikat</span>
Â  Â  Â  Â  Â  <span class="trend-value" style="color: var(--green)">341</span>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  </div>

Â  Â  <!-- Uutislaatikot -->
Â  Â  <div class="news-grid">

Â  Â  Â  <!-- Arctial-uutiset -->
Â  Â  Â  <div class="card">
Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  <div class="card-title">Arctial â€” uutiset</div>
Â  Â  Â  Â  Â  <a href="https://www.arctial.com/newsroom" target="_blank" style="font-size:0.72rem;color:var(--cyan);text-decoration:none;">arctial.com â†’</a>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="news-arctial">
Â  Â  Â  Â  Â  <div style="padding:16px;text-align:center;color:var(--text3);font-size:0.78rem;">â³ Ladataan...</div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <!-- Kokkola-uutiset -->
Â  Â  Â  <div class="card">
Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  <div class="card-title">Kokkola â€” uutiset</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="news-kokkola">
Â  Â  Â  Â  Â  <div style="padding:16px;text-align:center;color:var(--text3);font-size:0.78rem;">â³ Ladataan...</div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  </div>


Â  </div>
</div>

<!-- MODAL -->
<div class="modal-overlay" id="modal" onclick="closeModal(event)">
Â  <div class="modal">
Â  Â  <div class="modal-tag" id="modal-tag">PÃ¤Ã¤tÃ¶s</div>
Â  Â  <div class="modal-title" id="modal-title"></div>
Â  Â  <div class="modal-body" id="modal-body"></div>
Â  Â  <div class="modal-footer">
Â  Â  Â  <button class="btn-primary">Avaa tÃ¤ydet tiedot â†’</button>
Â  Â  Â  <button class="modal-close" onclick="closeModalDirect()">Sulje</button>
Â  Â  </div>
Â  </div>
</div>

<script>
Â  const PROXY_URL = 'https://kaupunki.onrender.com/decisions';
Â  const PROXY_MEETINGS_URL = 'https://kaupunki.onrender.com/meetings';

Â  // Tilastokeskus PxWeb API
Â  const STAT_URL = 'https://pxdata.stat.fi/PxWeb/api/v1/fi/StatFin/vaerak/statfin_vaerak_pxt_11ra.px';

Â  async function fetchStat(tiedot, vuosi) {
Â  Â  const body = {
Â  Â  Â  query: [
Â  Â  Â  Â  { code: 'Alue',Â  Â selection: { filter: 'item', values: ['KU272'] } },
Â  Â  Â  Â  { code: 'Tiedot', selection: { filter: 'item', values: [tiedot]Â  } },
Â  Â  Â  Â  { code: 'Vuosi',Â  selection: { filter: 'item', values: [vuosi]Â  Â } }
Â  Â  Â  ],
Â  Â  Â  response: { format: 'json' }
Â  Â  };
Â  Â  const res = await fetch(STAT_URL, {
Â  Â  Â  method: 'POST',
Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  body: JSON.stringify(body)
Â  Â  });
Â  Â  const data = await res.json();
Â  Â  return parseFloat(data.data[0]?.values[0]);
Â  }

Â  async function loadStats() {
Â  Â  const stats = [
Â  Â  Â  { tiedot: 'vaesto',Â  Â  Â  Â  elValue: 'stat-vaesto',Â  Â  Â elChange: 'stat-vaesto-change',Â  Â  Â format: v => Math.round(v).toLocaleString('fi-FI'), unit: 'hlÃ¶' },
Â  Â  Â  { tiedot: 'vaesto_alle15_p', elValue: 'stat-nuoret',Â  Â elChange: 'stat-nuoret-change',Â  Â  Â format: v => v.toFixed(1) + '%', unit: '%' },
Â  Â  ];

Â  Â  const years = ['2024', '2023'];

Â  Â  for (const s of stats) {
Â  Â  Â  try {
Â  Â  Â  Â  const [v2024, v2023] = await Promise.all([
Â  Â  Â  Â  Â  fetchStat(s.tiedot, years[0]),
Â  Â  Â  Â  Â  fetchStat(s.tiedot, years[1])
Â  Â  Â  Â  ]);

Â  Â  Â  Â  document.getElementById(s.elValue).textContent = s.format(v2024);

Â  Â  Â  Â  const diff = v2024 - v2023;
Â  Â  Â  Â  const sign = diff >= 0 ? '+' : '';
Â  Â  Â  Â  const changeEl = document.getElementById(s.elChange);
Â  Â  Â  Â  changeEl.textContent = `${sign}${s.unit === '%' ? diff.toFixed(1) + '%' : Math.round(diff).toLocaleString('fi-FI') + ' hlÃ¶'} (2024 vs 2023)`;
Â  Â  Â  Â  changeEl.className = 'stat-change ' + (diff > 0 ? 'up' : diff < 0 ? 'down' : 'neutral');
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  document.getElementById(s.elValue).textContent = 'â€“';
Â  Â  Â  Â  document.getElementById(s.elChange).textContent = 'virhe';
Â  Â  Â  }
Â  Â  }

Â  Â  // TyÃ¶ttÃ¶myysaste haetaan Tilastokeskukselta - Kokkola (KU272), kuukausitaso
Â  Â  try {
Â  Â  Â  const tyoUrl = 'https://pxdata.stat.fi/PxWeb/api/v1/fi/StatFin/tyonv/statfin_tyonv_pxt_12tf.px';

Â  Â  Â  // Hae metadata viimeisimmÃ¤t kuukaudet
Â  Â  Â  const metaRes = await fetch(tyoUrl);
Â  Â  Â  const meta = await metaRes.json();
Â  Â  Â  const kuukaudet = meta.variables.find(v => v.code === 'Kuukausi').values;
Â  Â  Â  const uusinKk = kuukaudet[kuukaudet.length - 1];
Â  Â  Â  const edellinenKk = kuukaudet[kuukaudet.length - 13]; // vuosi sitten

Â  Â  Â  const tyoBody = {
Â  Â  Â  Â  query: [
Â  Â  Â  Â  Â  { code: 'Alue',Â  Â  Â selection: { filter: 'item', values: ['KU272'] } },
Â  Â  Â  Â  Â  { code: 'Kuukausi', selection: { filter: 'item', values: [uusinKk, edellinenKk] } },
Â  Â  Â  Â  Â  { code: 'Tiedot',Â  Â selection: { filter: 'item', values: ['TYOTOSUUS'] } }
Â  Â  Â  Â  ],
Â  Â  Â  Â  response: { format: 'json' }
Â  Â  Â  };

Â  Â  Â  const tyoRes = await fetch(tyoUrl, {
Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  body: JSON.stringify(tyoBody)
Â  Â  Â  });
Â  Â  Â  const tyoData = await tyoRes.json();

Â  Â  Â  const uusinArvo = parseFloat(tyoData.data[0]?.values[0]);
Â  Â  Â  const edellinenArvo = parseFloat(tyoData.data[1]?.values[0]);

Â  Â  Â  if (!isNaN(uusinArvo)) {
Â  Â  Â  Â  document.getElementById('stat-tyottomyys').textContent = uusinArvo.toFixed(1) + '%';
Â  Â  Â  Â  const kkLabel = uusinKk.replace('M', '/');

Â  Â  Â  Â  if (!isNaN(edellinenArvo)) {
Â  Â  Â  Â  Â  const diff = uusinArvo - edellinenArvo;
Â  Â  Â  Â  Â  const sign = diff >= 0 ? '+' : '';
Â  Â  Â  Â  Â  const changeEl = document.getElementById('stat-tyottomyys-change');
Â  Â  Â  Â  Â  changeEl.textContent = sign + diff.toFixed(1) + '% vs vuosi sitten (' + kkLabel + ')';
Â  Â  Â  Â  Â  changeEl.className = 'stat-change ' + (diff > 0 ? 'up' : diff < 0 ? 'down' : 'neutral');
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  document.getElementById('stat-tyottomyys-change').textContent = kkLabel;
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  } catch(e) {
Â  Â  Â  document.getElementById('stat-tyottomyys').textContent = 'â€“';
Â  Â  Â  document.getElementById('stat-tyottomyys-change').textContent = 'ei dataa';
Â  Â  }
Â  }

Â  let activeFilter = 'all';
Â  let showAll = false;
Â  let activeQuery = '';

Â  function showView(name) {
Â  Â  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
Â  Â  document.getElementById('view-' + name).classList.add('active');
Â  Â  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
Â  Â  if (name === 'landing') document.querySelectorAll('.nav-btn')[0].classList.add('active');
Â  Â  if (name === 'dashboard') {
Â  Â  Â  document.querySelectorAll('.nav-btn')[1].classList.add('active');
Â  Â  Â  loadDecisions();
Â  Â  Â  loadStats();
Â  Â  Â  loadMeetings();
Â  Â  Â  loadAgendas();
Â  Â  }
Â  Â  document.getElementById('nav-search').style.display = name === 'dashboard' ? 'flex' : 'none';
Â  }

Â  async function loadDecisions() {
Â  Â  const list = document.getElementById('decisions-list');
Â  Â  list.innerHTML = '<div style="padding:32px 24px;text-align:center;color:var(--text3);font-size:0.8rem;">â³ Ladataan pÃ¤Ã¤tÃ¶ksiÃ¤ Kokkolasta...</div>';

Â  Â  try {
Â  Â  Â  const res = await fetch(PROXY_URL);
Â  Â  Â  const buffer = await res.arrayBuffer();
Â  Â  Â  let text = new TextDecoder("windows-1252").decode(buffer);
Â  Â  Â  text = text.replace(/encoding="[^"]+"/i, 'encoding="utf-8"');
Â  Â  Â  const parser = new DOMParser();
Â  Â  Â  const xml = parser.parseFromString(text, "application/xml");
Â  Â  Â  const items = xml.querySelectorAll("item");

Â  Â  Â  if (!items.length) {
Â  Â  Â  Â  list.innerHTML = '<div style="padding:32px 24px;text-align:center;color:var(--text3);font-size:0.8rem;">âš ï¸ Ei pÃ¤Ã¤tÃ¶ksiÃ¤ saatavilla</div>';
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  list.innerHTML = '';
Â  Â  Â  items.forEach(item => {
Â  Â  Â  Â  const title = item.querySelector('title')?.textContent || 'â€“';
Â  Â  Â  Â  const descÂ  = item.querySelector('description')?.textContent || '';
Â  Â  Â  Â  const linkÂ  = item.querySelector('link')?.textContent || '#';
Â  Â  Â  Â  const pubDate = item.querySelector('pubDate')?.textContent || '';

Â  Â  Â  Â  // Format date
Â  Â  Â  Â  let dateStr = '';
Â  Â  Â  Â  if (pubDate) {
Â  Â  Â  Â  Â  const d = new Date(pubDate);
Â  Â  Â  Â  Â  if (!isNaN(d)) dateStr = d.toLocaleDateString('fi-FI');
Â  Â  Â  Â  }

Â  Â  Â  Â  // Try to extract issuer from title (format: "Issuer / Decision title")
Â  Â  Â  Â  let issuer = 'Kokkola';
Â  Â  Â  Â  let decisionTitle = title;
Â  Â  Â  Â  if (title.includes(' / ')) {
Â  Â  Â  Â  Â  const parts = title.split(' / ');
Â  Â  Â  Â  Â  issuer = parts[0].trim();
Â  Â  Â  Â  Â  decisionTitle = parts.slice(1).join(' / ').trim();
Â  Â  Â  Â  }

Â  Â  Â  Â  const el = document.createElement('div');
Â  Â  Â  Â  el.className = 'decision-item';
Â  Â  Â  Â  el.dataset.status = 'passed';
Â  Â  Â  Â  el.dataset.text = (title + ' ' + desc).toLowerCase();
Â  Â  Â  Â  if (pubDate) { const pd = new Date(pubDate); if (!isNaN(pd)) el.dataset.date = pd.toISOString(); }
Â  Â  Â  Â  el.innerHTML = `
Â  Â  Â  Â  Â  <div class="decision-dot" style="background: var(--green)"></div>
Â  Â  Â  Â  Â  <div class="decision-content">
Â  Â  Â  Â  Â  Â  <div class="decision-title">${decisionTitle}</div>
Â  Â  Â  Â  Â  Â  <div class="decision-meta">
Â  Â  Â  Â  Â  Â  Â  <span>${issuer}</span>
Â  Â  Â  Â  Â  Â  Â  ${dateStr ? `<span>${dateStr}</span>` : ''}
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="decision-status status-passed">PÃ¤Ã¤tÃ¶s</div>
Â  Â  Â  Â  `;
Â  Â  Â  Â  el.addEventListener('click', () => openModal(decisionTitle, desc || 'Ei kuvausta saatavilla.', issuer + (dateStr ? ' Â· ' + dateStr : ''), link));
Â  Â  Â  Â  list.appendChild(el);
Â  Â  Â  });

Â  Â  Â  // Update badge count
Â  Â  Â  document.querySelector('.card-badge').textContent = items.length + ' kpl';
Â  Â  Â  if (activeFilter !== 'all') applyFilters();

Â  Â  } catch (e) {
Â  Â  Â  list.innerHTML = '<div style="padding:32px 24px;text-align:center;color:var(--red);font-size:0.8rem;">âš ï¸ Virhe ladattaessa pÃ¤Ã¤tÃ¶ksiÃ¤. Kokeile hetken kuluttua uudelleen.</div>';
Â  Â  }
Â  }

Â  async function loadMeetings() {
Â  Â  const list = document.getElementById('decisions-list');

Â  Â  try {
Â  Â  Â  const res = await fetch('https://kaupunki.onrender.com/meetings');
Â  Â  Â  const buffer = await res.arrayBuffer();
Â  Â  Â  let text = new TextDecoder('windows-1252').decode(buffer);
Â  Â  Â  text = text.replace(/encoding="[^"]+"/i, 'encoding="utf-8"');
Â  Â  Â  const parser = new DOMParser();
Â  Â  Â  const xml = parser.parseFromString(text, 'application/xml');
Â  Â  Â  const items = xml.querySelectorAll('item');

Â  Â  Â  if (!items.length) return;

Â  Â  Â  // Update 'tulevia pÃ¤Ã¤tÃ¶ksiÃ¤' counter with meeting count
Â  Â  Â  document.getElementById('stat-paatokset').textContent = items.length;

Â  Â  Â  // Fill 'Seuraavat kokoukset' is handled separately by loadAgendas()

Â  Â  Â  // Update decisions badge
Â  Â  Â  const current = parseInt(document.querySelector('.card-badge').textContent) || 0;
Â  Â  Â  document.querySelector('.card-badge').textContent = (current + items.length) + ' kpl';

Â  Â  Â  items.forEach(item => {
Â  Â  Â  Â  const getTag = (tag) => {
Â  Â  Â  Â  Â  const el = item.querySelector(tag);
Â  Â  Â  Â  Â  if (!el) return '';
Â  Â  Â  Â  Â  return (el.textContent || el.innerHTML || '').replace(/<!\[CDATA\[|\]\]>/g, '').trim();
Â  Â  Â  Â  };
Â  Â  Â  Â  const titleÂ  Â = getTag('title') || 'â€“';
Â  Â  Â  Â  const descÂ  Â  = getTag('description') || '';
Â  Â  Â  Â  const linkÂ  Â  = getTag('link') || '#';
Â  Â  Â  Â  const pubDate = getTag('pubDate') || '';

Â  Â  Â  Â  let dateStr = '';
Â  Â  Â  Â  if (pubDate) {
Â  Â  Â  Â  Â  const d = new Date(pubDate);
Â  Â  Â  Â  Â  if (!isNaN(d)) dateStr = d.toLocaleDateString('fi-FI');
Â  Â  Â  Â  }

Â  Â  Â  Â  let issuer = 'Kokkola';
Â  Â  Â  Â  let meetingTitle = title;
Â  Â  Â  Â  if (title.includes(' / ')) {
Â  Â  Â  Â  Â  const parts = title.split(' / ');
Â  Â  Â  Â  Â  issuer = parts[0].trim();
Â  Â  Â  Â  Â  meetingTitle = parts.slice(1).join(' / ').trim();
Â  Â  Â  Â  }

Â  Â  Â  Â  const el = document.createElement('div');
Â  Â  Â  Â  el.className = 'decision-item';
Â  Â  Â  Â  el.dataset.status = 'meeting';
Â  Â  Â  Â  el.dataset.text = (title + ' ' + desc).toLowerCase();
Â  Â  Â  Â  // Extract meeting date from title e.g. "monikulttuurisuusneuvosto 04.03.2026 / Asia"
Â  Â  Â  Â  const dmatch = title.match(/(\d{1,2})\.(\d{1,2})\.(\d{4})/);
Â  Â  Â  Â  if (dmatch) {
Â  Â  Â  Â  Â  const md = new Date(parseInt(dmatch[3]), parseInt(dmatch[2])-1, parseInt(dmatch[1]));
Â  Â  Â  Â  Â  if (!isNaN(md.getTime())) el.dataset.date = md.toISOString();
Â  Â  Â  Â  }
Â  Â  Â  Â  el.innerHTML =
Â  Â  Â  Â  Â  '<div class="decision-dot" style="background: var(--cyan)"></div>' +
Â  Â  Â  Â  Â  '<div class="decision-content">' +
Â  Â  Â  Â  Â  Â  '<div class="decision-title">' + meetingTitle + '</div>' +
Â  Â  Â  Â  Â  Â  '<div class="decision-meta">' +
Â  Â  Â  Â  Â  Â  Â  '<span>' + issuer + '</span>' +
Â  Â  Â  Â  Â  Â  Â  (dateStr ? '<span>' + dateStr + '</span>' : '') +
Â  Â  Â  Â  Â  Â  '</div>' +
Â  Â  Â  Â  Â  '</div>' +
Â  Â  Â  Â  Â  '<div class="decision-status status-review">Kokous</div>';
Â  Â  Â  Â  el.addEventListener('click', () => openModal(meetingTitle, desc || 'Ei kuvausta.', issuer + (dateStr ? ' - ' + dateStr : ''), link));
Â  Â  Â  Â  list.appendChild(el);
Â  Â  Â  });
Â  Â  Â  if (activeFilter !== 'all') applyFilters();

Â  Â  } catch(e) {
Â  Â  Â  console.error('Virhe ladattaessa kokousasioita:', e);
Â  Â  }
Â  }

Â  let allAgendaItems = [];
Â  let meetingFilter = 'all';

Â  function setMeetingFilter(filter, btn) {
Â  Â  meetingFilter = filter;
Â  Â  document.querySelectorAll('#mkf-tulevat, #mkf-menneet, #mkf-kh, #mkf-all').forEach(b => b.classList.remove('active'));
Â  Â  btn.classList.add('active');
Â  Â  renderAgendasTop();
Â  }

Â  function renderAgendasTop() {
Â  Â  const list = document.getElementById('upcoming-meetings-list-top');
Â  Â  if (!list) return;
Â  Â  const now = new Date();

Â  Â  const searchVal = (document.getElementById('meeting-search')?.value || '').toLowerCase().trim();

Â  Â  let filtered = allAgendaItems.filter(item => {
Â  Â  Â  const d = item.date ? new Date(item.date) : null;
Â  Â  Â  const year = d ? d.getFullYear() : null;
Â  Â  Â  if (meetingFilter === 'tulevat') { if (!((!d || d >= now))) return false; }
Â  Â  Â  else if (meetingFilter === 'menneet') { if (!(d && d < now && year >= 2026)) return false; }
Â  Â  Â  else if (meetingFilter === 'kh') { if (!item.title.toLowerCase().includes('kaupunginhallitus')) return false; }
Â  Â  Â  if (searchVal && !item.title.toLowerCase().includes(searchVal)) return false;
Â  Â  Â  return true;
Â  Â  });

Â  Â  // JÃ¤rjestys: tulevat aika-jÃ¤rjestyksessÃ¤, muut uusimmat ensin
Â  Â  if (meetingFilter === 'tulevat') {
Â  Â  Â  filtered.sort((a, b) => (a.date || '') < (b.date || '') ? -1 : 1);
Â  Â  } else {
Â  Â  Â  filtered.sort((a, b) => (a.date || '') > (b.date || '') ? -1 : 1);
Â  Â  }

Â  Â  filtered = filtered.slice(0, 8);

Â  Â  if (filtered.length === 0) {
Â  Â  Â  list.innerHTML = '<div style="padding:16px;color:var(--text3);font-size:0.78rem;">Ei kokouksia</div>';
Â  Â  Â  return;
Â  Â  }
Â  Â  list.innerHTML = filtered.map(item =>
Â  Â  Â  '<a href="' + item.link + '" target="_blank" class="upcoming-item">' +
Â  Â  Â  Â  (item.dateStr ? '<div class="upcoming-date">' + item.dateStr + '</div>' : '') +
Â  Â  Â  Â  '<div class="upcoming-title">' + item.title + '</div>' +
Â  Â  Â  Â  '<div class="upcoming-body">Avaa esityslista â†’</div>' +
Â  Â  Â  '</a>'
Â  Â  ).join('');
Â  }

Â  function switchMeetingTab(tab, btn) {
Â  Â  document.querySelectorAll('.meeting-tab').forEach(b => b.classList.remove('active'));
Â  Â  btn.classList.add('active');
Â  Â  renderAgendas(tab);
Â  }

Â  function renderAgendas(tab) {
Â  Â  const list = document.getElementById('upcoming-meetings-list');
Â  Â  if (!list) return;
Â  Â  const now = new Date();

Â  Â  const filtered = allAgendaItems.filter(item => {
Â  Â  Â  const d = item.date ? new Date(item.date) : null;
Â  Â  Â  if (tab === 'future') return !d || d >= now;
Â  Â  Â  if (tab === 'past')Â  Â return d && d < now;
Â  Â  Â  return true;
Â  Â  }).slice(0, 8);

Â  Â  list.innerHTML = '';
Â  Â  if (!filtered.length) {
Â  Â  Â  list.innerHTML = '<div style="padding:16px;color:var(--text3);font-size:0.78rem;">Ei kokouksia</div>';
Â  Â  Â  return;
Â  Â  }

Â  Â  filtered.forEach(item => {
Â  Â  Â  const el = document.createElement('div');
Â  Â  Â  el.className = 'upcoming-item';
Â  Â  Â  el.innerHTML = '<a href="' + item.link + '" target="_blank">' +
Â  Â  Â  Â  (item.dateStr ? '<div class="upcoming-date">' + item.dateStr + '</div>' : '') +
Â  Â  Â  Â  '<div class="upcoming-title">' + item.title + '</div>' +
Â  Â  Â  Â  '<div class="upcoming-body">Avaa esityslista â†’</div>' +
Â  Â  Â  Â  '</a>';
Â  Â  Â  list.appendChild(el);
Â  Â  });
Â  }

Â  async function loadAgendas() {
Â  Â  const list = document.getElementById('upcoming-meetings-list');
Â  Â  if (!list) return;

Â  Â  try {
Â  Â  Â  const res = await fetch('https://kaupunki.onrender.com/agendas');
Â  Â  Â  const buffer = await res.arrayBuffer();
Â  Â  Â  let text = new TextDecoder('windows-1252').decode(buffer);
Â  Â  Â  text = text.replace(/encoding="[^"]+"/i, 'encoding="utf-8"');
Â  Â  Â  const parser = new DOMParser();
Â  Â  Â  const xml = parser.parseFromString(text, 'application/xml');
Â  Â  Â  const items = Array.from(xml.querySelectorAll('item'));

Â  Â  Â  allAgendaItems = items.map(item => {
Â  Â  Â  Â  const fullTitle = item.querySelector('title')?.textContent || 'â€“';
Â  Â  Â  Â  const linkUrlÂ  Â = item.querySelector('link')?.textContent || '#';

Â  Â  Â  Â  // Extract date from title: "Kaupunginhallitus 03.03.2026" -> "03.03.2026"
Â  Â  Â  Â  const dateMatch = fullTitle.match(/(\d{1,2})\.(\d{1,2})\.(\d{4})/);
Â  Â  Â  Â  let dateStr = '';
Â  Â  Â  Â  let date = null;
Â  Â  Â  Â  let title = fullTitle;
Â  Â  Â  Â  if (dateMatch) {
Â  Â  Â  Â  Â  const [, day, mon, year] = dateMatch;
Â  Â  Â  Â  Â  const d = new Date(year, mon - 1, day);
Â  Â  Â  Â  Â  if (!isNaN(d.getTime())) {
Â  Â  Â  Â  Â  Â  date = d.toISOString();
Â  Â  Â  Â  Â  Â  dateStr = d.toLocaleDateString('fi-FI', {weekday:'short', day:'numeric', month:'numeric', year:'numeric'});
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  // Remove date from title display
Â  Â  Â  Â  Â  title = fullTitle.replace(dateMatch[0], '').trim();
Â  Â  Â  Â  }
Â  Â  Â  Â  return { title, link: linkUrl, date, dateStr };
Â  Â  Â  });

Â  Â  Â  // Sort: future ascending, past descending
Â  Â  Â  const now = new Date();
Â  Â  Â  allAgendaItems.sort((a, b) => {
Â  Â  Â  Â  const da = a.date ? new Date(a.date) : now;
Â  Â  Â  Â  const db = b.date ? new Date(b.date) : now;
Â  Â  Â  Â  const aFuture = da >= now;
Â  Â  Â  Â  const bFuture = db >= now;
Â  Â  Â  Â  if (aFuture && bFuture) return da - db; // tulevat: lÃ¤himmÃ¤t ensin
Â  Â  Â  Â  if (!aFuture && !bFuture) return db - da; // menneet: uusimmat ensin
Â  Â  Â  Â  return 0;
Â  Â  Â  });

Â  Â  Â  renderAgendas('future');
Â  Â  Â  renderAgendasTop();
Â  Â  Â  loadNews();

Â  Â  } catch(e) {
Â  Â  Â  list.innerHTML = '<div style="padding:16px;color:var(--text3);font-size:0.78rem;">Virhe ladattaessa kokouksia</div>';
Â  Â  }
Â  }

Â  function setFilter(filter, btn) {
Â  Â  activeFilter = filter;
Â  Â  showAll = false;
Â  Â  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
Â  Â  btn.classList.add('active');
Â  Â  applyFilters();
Â  }

Â  function handleSearch(value) {
Â  Â  activeQuery = value.trim().toLowerCase();
Â  Â  document.getElementById('searchClear').style.display = activeQuery ? 'block' : 'none';
Â  Â  applyFilters();
Â  }

Â  function clearSearch() {
Â  Â  document.getElementById('searchInput').value = '';
Â  Â  activeQuery = '';
Â  Â  document.getElementById('searchClear').style.display = 'none';
Â  Â  applyFilters();
Â  Â  document.getElementById('searchInput').focus();
Â  }

Â  function applyFilters() {
Â  Â  const now = new Date();
Â  Â  const items = document.querySelectorAll('#decisions-list .decision-item');
Â  Â  let visible = 0;
Â  Â  items.forEach(item => {
Â  Â  Â  const status = item.dataset.status;
Â  Â  Â  const text = (item.dataset.text + ' ' + item.innerText).toLowerCase();
Â  Â  Â  const itemDate = item.dataset.date ? new Date(item.dataset.date) : null;

Â  Â  Â  let matchFilter = false;
Â  Â  Â  if (activeFilter === 'all') {
Â  Â  Â  Â  matchFilter = true;
Â  Â  Â  } else if (activeFilter === 'viranomais') {
Â  Â  Â  Â  // ViranomaispÃ¤Ã¤tÃ¶kset: vain RSS /decisions
Â  Â  Â  Â  matchFilter = status === 'passed';
Â  Â  Â  } else if (activeFilter === 'paatokset') {
Â  Â  Â  Â  // Tehdyt pÃ¤Ã¤tÃ¶kset: viranomaispÃ¤Ã¤tÃ¶kset + menneet kokousasiat
Â  Â  Â  Â  matchFilter = status === 'passed' || (status === 'meeting' && itemDate && itemDate < now);
Â  Â  Â  } else if (activeFilter === 'esitykset') {
Â  Â  Â  Â  // Esitykset: tulevat kokousasiat
Â  Â  Â  Â  matchFilter = status === 'meeting' && (!itemDate || itemDate >= now);
Â  Â  Â  } else {
Â  Â  Â  Â  matchFilter = status === activeFilter;
Â  Â  Â  }

Â  Â  Â  const matchQuery = !activeQuery || text.includes(activeQuery);
Â  Â  Â  const show = matchFilter && matchQuery;
Â  Â  Â  item.style.display = show ? '' : 'none';
Â  Â  Â  if (show) {
Â  Â  Â  Â  const titleEl = item.querySelector('.decision-title');
Â  Â  Â  Â  if (activeQuery && titleEl) {
Â  Â  Â  Â  Â  const orig = titleEl.textContent;
Â  Â  Â  Â  Â  const idx = orig.toLowerCase().indexOf(activeQuery);
Â  Â  Â  Â  Â  if (idx >= 0) {
Â  Â  Â  Â  Â  Â  titleEl.innerHTML = orig.slice(0, idx)
Â  Â  Â  Â  Â  Â  Â  + '<span class="search-highlight">' + orig.slice(idx, idx + activeQuery.length) + '</span>'
Â  Â  Â  Â  Â  Â  Â  + orig.slice(idx + activeQuery.length);
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  visible++;
Â  Â  Â  }
Â  Â  });

Â  Â  // NÃ¤ytÃ¤ oletuksena vain 10, ellei showAll tai hakusana aktiivinen
Â  Â  if (!showAll && !activeQuery) {
Â  Â  Â  let shown = 0;
Â  Â  Â  items.forEach(item => {
Â  Â  Â  Â  if (item.style.display !== 'none') {
Â  Â  Â  Â  Â  shown++;
Â  Â  Â  Â  Â  if (shown > 10) item.style.display = 'none';
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  Â  visible = Math.min(visible, 10);
Â  Â  }

Â  Â  document.getElementById('search-empty').style.display = visible === 0 ? 'block' : 'none';
Â  Â  const showMoreBtn = document.getElementById('show-more-btn');
Â  Â  if (showMoreBtn) showMoreBtn.style.display = (!showAll && !activeQuery && visible >= 10) ? 'block' : 'none';
Â  }

Â  async function loadNews() {
Â  Â  for (const aihe of ['arctial', 'kokkola']) {
Â  Â  Â  const el = document.getElementById('news-' + aihe);
Â  Â  Â  if (!el) continue;
Â  Â  Â  try {
Â  Â  Â  Â  const res = await fetch('https://kaupunki.onrender.com/news/' + aihe);
Â  Â  Â  Â  const items = await res.json();
Â  Â  Â  Â  if (!items || items.length === 0) {
Â  Â  Â  Â  Â  el.innerHTML = '<div style="padding:16px;color:var(--text3);font-size:0.78rem;">Ei uutisia saatavilla</div>';
Â  Â  Â  Â  Â  continue;
Â  Â  Â  Â  }
Â  Â  Â  Â  el.innerHTML = items.map(item =>
Â  Â  Â  Â  Â  '<a href="' + (item.url || '#') + '" target="_blank" class="news-item">' +
Â  Â  Â  Â  Â  Â  '<div class="news-title">' + item.otsikko + '</div>' +
Â  Â  Â  Â  Â  Â  (item.julkaistu ? '<div class="news-meta">' + item.julkaistu + '</div>' : '') +
Â  Â  Â  Â  Â  Â  (item.kuvaus ? '<div class="news-desc">' + item.kuvaus + '</div>' : '') +
Â  Â  Â  Â  Â  '</a>'
Â  Â  Â  Â  ).join('');
Â  Â  Â  } catch(e) {
Â  Â  Â  Â  el.innerHTML = '<div style="padding:16px;color:var(--text3);font-size:0.78rem;">Virhe ladattaessa uutisia</div>';
Â  Â  Â  }
Â  Â  }
Â  }

Â  function openModal(title, body, tag, link) {
Â  Â  document.getElementById('modal-title').textContent = title;
Â  Â  document.getElementById('modal-body').textContent = body;
Â  Â  document.getElementById('modal-tag').textContent = tag;
Â  Â  // Update the "Avaa tÃ¤ydet tiedot" button link
Â  Â  const btn = document.querySelector('.modal-footer .btn-primary');
Â  Â  btn.onclick = () => window.open(link, '_blank');
Â  Â  document.getElementById('modal').classList.add('open');
Â  }

Â  function closeModal(e) {
Â  Â  if (e.target === document.getElementById('modal')) {
Â  Â  Â  document.getElementById('modal').classList.remove('open');
Â  Â  }
Â  }

Â  function closeModalDirect() {
Â  Â  document.getElementById('modal').classList.remove('open');
Â  }
</script>
</body>
</html>
